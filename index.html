<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="With fun game modes provides much more features than official website">
<meta name="keywords" content="agario fun, agario lol, agario.lol, agario, agar, io, agar.io lol, cell, cells, virus, bacteria, blob, game, games, web game, html5, fun, flash">
<meta name="robots" content="index, follow">
<meta name="viewport" content="minimal-ui, width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta property="fb:app_id" content="1023344604389308">
<meta property="og:title" content="Agario.fun">
<meta property="og:description" content="With fun game modes provides much more features than official website">
<meta property="og:url" content="https://web.archive.org/web/20221013160740/https://agario.fun/">
<meta property="og:image" content="https://web.archive.org/web/20221013160740im_/http://agario.fun/img/1200x630.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:type" content="website">
<title>Agario.fun Funny Mode Agario Game Server</title>
<link rel="canonical" href="https://web.archive.org/web/20221013160740/https://agario.fun/">
<meta name="yandex-verification" content="fab8ce01115ed3dc" />
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<style>
  body {
    margin: 0;
    overflow: hidden;
  }

  iframe {
    width: 100%;
    height: 100vh;
    border: none;
    display: block;
  }
        #onlineCount {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: rgba(255, 255, 255, 0.7); /* Optional: Add background for readability */
            padding: 5px;
            border-radius: 5px; /* Optional: Rounded corners */
            font-family: sans-serif;
        }
</style>
</head>
<body>
<div id="onlineCount">Online: 0</div>
<script>
    const onlineCountElement = document.getElementById('onlineCount');
    const ws = new WebSocket('wss://itana.pw:6006');

    ws.onopen = () => {
        console.log("Connected to WebSocket server");
    };

    ws.onmessage = (event) => {
        try {
            const data = JSON.parse(event.data);

            if (data && data.type === 'online') { // **Улучшение: Проверка наличия data**
                const onlineCount = parseInt(data.count, 10); // **Улучшение: Преобразование в число**
                if (!isNaN(onlineCount)) { // **Улучшение: Проверка, что это число**
                    onlineCountElement.textContent = 'Online: ' + onlineCount;
                } else {
                    console.warn("Invalid online count received:", data.count); // **Улучшение: Предупреждение о некорректных данных**
                }
            } else {
                console.log("Received message:", data);
            }
        } catch (error) {
            console.error("Error parsing message:", error);
            console.log("Raw message:", event.data);
        }
    };

    ws.onclose = () => {
        console.log("Disconnected from WebSocket server");
    };

    ws.onerror = (error) => {
        console.error("WebSocket error:", error);
        // **Улучшение:  Попытка переподключения**
        console.log("Attempting to reconnect in 5 seconds...");
        setTimeout(() => {
            ws = new WebSocket('wss://itana.pw:6006'); // Создаем новый объект WebSocket
        }, 5000);
    };

    // **Улучшение: Обработчик ухода со страницы**
    window.addEventListener('beforeunload', () => {
        ws.close();
    });
</script>

  <iframe src="https://agartime.ru"></iframe>

</body>
</html>
